import pandas as pd

# Load data
reference = pd.read_csv("data/reference_data.csv")
current = pd.read_csv("data/current_data.csv")

# Basic statistics
print("REFERENCE DATA STATS")
print(reference.describe())
print("\nCURRENT DATA STATS")
print(current.describe())

# Compare meansTHRESHOLD = 0.2  # 20%

print("\nDRIFT CHECK")
for column in reference.columns:
    ref_mean = reference[column].mean()
    cur_mean = current[column].mean()

    if ref_mean == 0:
        continue

    change_ratio = abs(cur_mean - ref_mean) / ref_mean

    if change_ratio > THRESHOLD:
        status = "DRIFT DETECTED"
    else:
        status = "OK"

    print(
        f"{column}: "
        f"reference={ref_mean:.2f}, "
        f"current={cur_mean:.2f}, "
        f"change={change_ratio*100:.1f}%, "
        f"status={status}"
    )

